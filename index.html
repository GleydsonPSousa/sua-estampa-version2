<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sua Estampa Confecção | Oficial SJC</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Fontes e Ícones -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap');
        
        :root { 
            --navy: #0f1e36; 
            --bronze: #c2814b;
            --bronze-light: #e0a370;
            scroll-behavior: smooth; 
        }
        
        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            background-color: #fcfaf8; 
            overflow-x: hidden;
        }
        
        .glass {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(12px);
            border-bottom: 2px solid var(--bronze);
        }

        .text-gradient-brand {
            background: linear-gradient(135deg, var(--navy) 0%, var(--bronze) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .bg-navy { background-color: var(--navy); }
        .bg-bronze { background-color: var(--bronze); }
        .text-navy { color: var(--navy); }
        .text-bronze { color: var(--bronze); }

        .btn-brand {
            background-color: var(--navy);
            color: white;
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }

        .btn-brand:hover {
            background-color: transparent;
            color: var(--navy);
            border-color: var(--navy);
            transform: translateY(-2px);
        }

        .btn-bronze {
            background-color: var(--bronze);
            color: white;
            transition: all 0.3s ease;
        }

        .btn-bronze:hover {
            background-color: #a66d3e;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px -5px rgba(194, 129, 75, 0.4);
        }

        /* Estilo da Timeline */
        .step-dot { width: 14px; height: 14px; border-radius: 50%; background: #e2e8f0; position: relative; z-index: 10; transition: all 0.4s ease; }
        .step-dot.active { background: var(--bronze); box-shadow: 0 0 0 5px rgba(194, 129, 75, 0.2); transform: scale(1.2); }

        .status-card {
            display: none;
            animation: slideUp 0.5s ease-out forwards;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .loader {
            width: 20px; height: 20px; border: 3px solid #FFF; border-bottom-color: transparent;
            border-radius: 50%; display: none; animation: rotation 1s linear infinite;
        }

        @keyframes rotation { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .whatsapp-float {
            position: fixed; bottom: 30px; right: 30px; background-color: #25d366; color: white;
            width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center;
            justify-content: center; font-size: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            z-index: 1000; transition: all 0.3s ease;
        }
        
        .modal-admin {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(15, 30, 54, 0.95); z-index: 2000; backdrop-filter: blur(10px);
        }

        .admin-tab-btn { transition: all 0.3s ease; border-bottom: 2px solid transparent; }
        .admin-tab-btn.active { border-bottom: 2px solid var(--bronze); color: var(--bronze); }

        .admin-scroll::-webkit-scrollbar { width: 6px; }
        .admin-scroll::-webkit-scrollbar-track { background: transparent; }
        .admin-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
    </style>
</head>
<body>

    <!-- Botão Flutuante WhatsApp -->
    <a href="https://wa.me/5512987106510" target="_blank" class="whatsapp-float">
        <i class="fab fa-whatsapp"></i>
    </a>

    <!-- Header -->
    <nav class="fixed w-full z-[100] glass py-3">
        <div class="container mx-auto px-6 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <div class="relative w-12 h-12 bg-navy rounded-full border-2 border-bronze flex items-center justify-center overflow-hidden">
                    <span class="text-bronze font-serif text-xl">S</span>
                </div>
                <div class="flex flex-col">
                    <span class="text-lg font-extrabold text-navy leading-none uppercase">Sua Estampa</span>
                    <span class="text-[9px] font-bold text-bronze tracking-[0.2em] uppercase">Confecção & Estamparia</span>
                </div>
            </div>
            <div class="flex items-center gap-4">
                <button onclick="openAdmin()" class="text-navy/50 hover:text-navy text-xs font-bold uppercase tracking-tighter transition-all">
                    <i class="fas fa-lock mr-1"></i> Admin
                </button>
                <a href="https://wa.me/5512987106510" target="_blank" class="bg-navy text-white px-5 py-2.5 rounded-full text-xs font-bold btn-brand shadow-lg">
                    ORÇAMENTO <i class="fab fa-whatsapp ml-1"></i>
                </a>
            </div>
        </div>
    </nav>

    <!-- Hero -->
    <section class="pt-40 pb-24 px-6 relative overflow-hidden">
        <div class="absolute -top-24 -right-24 w-96 h-96 bg-bronze opacity-5 rounded-full blur-3xl"></div>
        <div class="container mx-auto text-center relative z-10">
            <div data-aos="fade-down" class="inline-flex items-center gap-2 bg-stone-100 text-stone-600 px-4 py-2 rounded-full text-[10px] font-bold uppercase tracking-widest mb-8 border border-stone-200">
                <i class="fas fa-certificate text-bronze"></i> Estamparia Profissional em SJC
            </div>
            <h1 data-aos="fade-up" class="text-5xl md:text-7xl font-extrabold text-navy mb-6 leading-tight tracking-tighter">
                Sua marca, <br><span class="text-gradient-brand">nossa estampa.</span>
            </h1>
            <p data-aos="fade-up" data-aos-delay="100" class="text-slate-600 text-base md:text-xl max-w-2xl mx-auto mb-12 font-medium">
                Do design à entrega final, cuidamos de cada detalhe com total transparência e qualidade premium.
            </p>
            <div data-aos="fade-up" data-aos-delay="200" class="flex flex-col sm:flex-row justify-center gap-5">
                <a href="#rastreio" class="btn-bronze px-10 py-5 rounded-full font-extrabold text-lg shadow-xl text-center">Acompanhar Pedido</a>
                <a href="https://wa.me/5512987106510" target="_blank" class="bg-white text-navy border-2 border-navy px-10 py-5 rounded-full font-extrabold text-lg hover:bg-slate-50 transition-all text-center">Falar no WhatsApp</a>
            </div>
        </div>
    </section>

    <!-- Rastreio -->
    <section id="rastreio" class="py-24 bg-white">
        <div class="container mx-auto px-6">
            <div class="max-w-5xl mx-auto bg-navy rounded-[3rem] p-8 md:p-16 border border-bronze/30 shadow-2xl relative">
                <div class="relative z-10">
                    <div class="text-center md:text-left mb-12">
                        <h2 class="text-3xl font-extrabold text-white mb-3">Linha do Tempo de Produção</h2>
                        <p class="text-bronze font-bold text-sm uppercase tracking-widest">Veja em qual etapa está o seu uniforme</p>
                    </div>

                    <div class="flex flex-col md:flex-row gap-4 bg-white/10 p-3 rounded-[2rem] border border-white/20 mb-12">
                        <div class="flex-1 flex items-center px-6 py-3">
                            <i class="fas fa-search text-bronze mr-4 text-xl"></i>
                            <input type="text" id="inputProtocolo" placeholder="SEU PROTOCOLO O.S." 
                                   class="w-full bg-transparent outline-none font-bold text-white placeholder:text-white/30 uppercase text-lg">
                        </div>
                        <button onclick="consultar()" id="btnConsultar" class="btn-bronze px-12 py-5 rounded-[1.5rem] font-black text-sm flex items-center justify-center gap-3">
                            <span id="labelBtn">BUSCAR</span>
                            <div id="spinner" class="loader"></div>
                        </button>
                    </div>

                    <!-- Resultado -->
                    <div id="statusResult" class="status-card bg-white rounded-[2rem] p-8 md:p-12 shadow-inner text-navy">
                        <div class="flex flex-wrap justify-between items-start gap-6 border-b border-stone-100 pb-8 mb-10">
                            <div>
                                <p class="text-[10px] font-black text-bronze uppercase mb-2 tracking-widest">Status Atual</p>
                                <h3 id="resStatus" class="text-3xl font-black uppercase">---</h3>
                            </div>
                            <div class="text-right">
                                <p class="text-[10px] font-black text-stone-400 uppercase mb-2 tracking-widest" id="resId">O.S. ---</p>
                                <h4 id="resNome" class="text-xl font-bold">---</h4>
                            </div>
                        </div>

                        <!-- Timeline -->
                        <div class="mb-16 px-4 overflow-x-auto">
                            <div class="relative flex justify-between items-center min-w-[600px] py-6">
                                <div class="absolute h-1.5 w-full bg-stone-100 top-1/2 -translate-y-1/2 rounded-full"></div>
                                <div id="timelineProgress" class="absolute h-1.5 bg-bronze top-1/2 -translate-y-1/2 rounded-full transition-all duration-1000" style="width: 0%"></div>
                                
                                <div class="flex flex-col items-center gap-3 relative z-10"><div class="step-dot active"></div><span class="text-[9px] font-black uppercase">Pedido</span></div>
                                <div class="flex flex-col items-center gap-3 relative z-10"><div id="dot-corte" class="step-dot"></div><span class="text-[9px] font-black uppercase text-stone-300" id="lbl-corte">Corte</span></div>
                                <div class="flex flex-col items-center gap-3 relative z-10"><div id="dot-costura" class="step-dot"></div><span class="text-[9px] font-black uppercase text-stone-300" id="lbl-costura">Costura</span></div>
                                <div class="flex flex-col items-center gap-3 relative z-10"><div id="dot-estampa" class="step-dot"></div><span class="text-[9px] font-black uppercase text-stone-300" id="lbl-estampa">Estampa</span></div>
                                <div class="flex flex-col items-center gap-3 relative z-10"><div id="dot-pronto" class="step-dot"></div><span class="text-[9px] font-black uppercase text-stone-300" id="lbl-pronto">Pronto</span></div>
                                <div class="flex flex-col items-center gap-3 relative z-10"><div id="dot-fim" class="step-dot"></div><span class="text-[9px] font-black uppercase text-stone-300" id="lbl-fim">Entrega</span></div>
                            </div>
                        </div>

                        <div class="bg-stone-50 rounded-2xl p-6 flex items-center justify-between">
                            <div class="flex items-center gap-4">
                                <i class="fas fa-calendar-alt text-bronze"></i>
                                <span class="text-xs font-bold uppercase tracking-wider">Previsão:</span>
                            </div>
                            <span id="resPrevisao" class="font-black">---</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Portfólio de Imagens -->
    <section id="portfolio" class="py-24 bg-stone-50">
        <div class="container mx-auto px-6">
            <div class="text-center mb-16" data-aos="fade-up">
                <h2 class="text-4xl font-black text-navy mb-4">Portfólio em Destaque</h2>
                <p class="text-stone-500 max-w-xl mx-auto">Confira os detalhes das nossas produções reais.</p>
            </div>
            
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="group relative overflow-hidden rounded-[2.5rem] bg-white shadow-xl aspect-square" data-aos="zoom-in">
                    <img src="https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?q=80&w=800" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700" alt="Produto 1">
                    <div class="absolute inset-0 bg-navy/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center p-8 text-center">
                        <span class="text-white font-black text-xs uppercase tracking-widest">DTF de Alta Definição</span>
                    </div>
                </div>
                <div class="group relative overflow-hidden rounded-[2.5rem] bg-white shadow-xl aspect-square" data-aos="zoom-in" data-aos-delay="100">
                    <img src="https://images.unsplash.com/photo-1576566588028-4147f3842f27?q=80&w=800" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700" alt="Produto 2">
                    <div class="absolute inset-0 bg-navy/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center p-8 text-center">
                        <span class="text-white font-black text-xs uppercase tracking-widest">Uniformes Corporativos</span>
                    </div>
                </div>
                <div class="group relative overflow-hidden rounded-[2.5rem] bg-white shadow-xl aspect-square" data-aos="zoom-in" data-aos-delay="200">
                    <img src="https://images.unsplash.com/photo-1503342217505-b0a15ec3261c?q=80&w=800" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700" alt="Produto 3">
                    <div class="absolute inset-0 bg-navy/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center p-8 text-center">
                        <span class="text-white font-black text-xs uppercase tracking-widest">Silk Screen Profissional</span>
                    </div>
                </div>
                <div class="group relative overflow-hidden rounded-[2.5rem] bg-white shadow-xl aspect-square" data-aos="zoom-in" data-aos-delay="300">
                    <img src="https://images.unsplash.com/photo-1554568218-0f1715e72254?q=80&w=800" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700" alt="Produto 4">
                    <div class="absolute inset-0 bg-navy/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center p-8 text-center">
                        <span class="text-white font-black text-xs uppercase tracking-widest">Confecção Própria</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Admin Modal -->
    <div id="adminModal" class="modal-admin items-center justify-center p-6">
        <div class="bg-white w-full max-w-5xl rounded-[3rem] p-8 md:p-12 relative shadow-2xl overflow-y-auto max-h-[90vh] admin-scroll">
            <button onclick="closeAdmin()" class="absolute top-8 right-8 text-navy/20 hover:text-navy transition-colors"><i class="fas fa-times-circle text-3xl"></i></button>
            
            <div id="adminLogin">
                <div class="text-center mb-10">
                    <h2 class="text-3xl font-black text-navy uppercase">Painel de Gestão</h2>
                    <p class="text-xs text-stone-400 font-bold uppercase tracking-widest">Acesso Restrito</p>
                </div>
                <div class="flex flex-col gap-4 max-w-xs mx-auto">
                    <input type="password" id="adminPass" placeholder="SENHA" class="w-full p-5 border rounded-3xl text-center font-bold tracking-[0.5em] outline-none border-stone-100 bg-stone-50">
                    <button onclick="checkAdmin()" class="bg-navy text-white p-5 rounded-3xl font-black hover:bg-navy/90 transition-all">ENTRAR NO SISTEMA</button>
                </div>
            </div>

            <div id="adminContent" class="hidden text-navy">
                <div class="flex flex-col md:flex-row justify-between items-center mb-12 gap-6 border-b border-stone-100 pb-8">
                    <div>
                        <h2 class="text-3xl font-black">Área Administrativa</h2>
                        <p class="text-bronze text-[10px] font-black uppercase tracking-[0.2em] mt-1">Sincronizado com Google Planilhas</p>
                    </div>
                    <div class="flex bg-stone-100 p-1.5 rounded-2xl">
                        <button onclick="switchTab('caixa')" id="tabBtnCaixa" class="admin-tab-btn active px-6 py-3 text-[10px] font-black uppercase">Fluxo de Caixa</button>
                        <button onclick="switchTab('pedidos')" id="tabBtnPedidos" class="admin-tab-btn px-6 py-3 text-[10px] font-black uppercase">Gestão de Pedidos</button>
                    </div>
                </div>

                <!-- Aba Fluxo de Caixa -->
                <div id="tabCaixa">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
                        <div class="bg-stone-50 p-8 rounded-[2rem] border border-stone-100">
                            <p class="text-[9px] font-black text-green-600 uppercase tracking-widest mb-2">Entradas</p>
                            <p class="text-2xl font-black" id="finEntradas">R$ 0,00</p>
                        </div>
                        <div class="bg-stone-50 p-8 rounded-[2rem] border border-stone-100">
                            <p class="text-[9px] font-black text-red-600 uppercase tracking-widest mb-2">Saídas</p>
                            <p class="text-2xl font-black" id="finSaidas">R$ 0,00</p>
                        </div>
                        <div class="bg-navy p-8 rounded-[2rem]">
                            <p class="text-[9px] font-black text-bronze uppercase tracking-widest mb-2">Saldo Total</p>
                            <p class="text-2xl font-black text-white" id="finSaldo">R$ 0,00</p>
                        </div>
                    </div>

                    <div class="bg-stone-50 rounded-[2rem] p-10 border border-stone-100">
                        <h3 class="text-xs font-black uppercase tracking-widest mb-8">Novo Lançamento Financeiro</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                            <div class="space-y-2">
                                <label class="text-[9px] font-black text-stone-400 uppercase tracking-widest ml-1">Data</label>
                                <input type="date" id="movData" class="w-full p-4 rounded-2xl border-none shadow-sm font-bold text-xs outline-none focus:ring-2 focus:ring-bronze bg-white">
                            </div>
                            <div class="space-y-2">
                                <label class="text-[9px] font-black text-stone-400 uppercase tracking-widest ml-1">Descrição</label>
                                <input type="text" id="movDesc" placeholder="EX: COMPRA DE MALHA" class="w-full p-4 rounded-2xl border-none shadow-sm font-bold uppercase text-xs outline-none focus:ring-2 focus:ring-bronze">
                            </div>
                            <div class="space-y-2">
                                <label class="text-[9px] font-black text-stone-400 uppercase tracking-widest ml-1">Valor R$</label>
                                <input type="number" id="movValor" placeholder="0.00" class="w-full p-4 rounded-2xl border-none shadow-sm font-bold text-xs outline-none focus:ring-2 focus:ring-bronze">
                            </div>
                            <div class="space-y-2">
                                <label class="text-[9px] font-black text-stone-400 uppercase tracking-widest ml-1">Tipo</label>
                                <select id="movTipo" class="w-full p-4 rounded-2xl border-none shadow-sm font-bold text-xs outline-none focus:ring-2 focus:ring-bronze bg-white">
                                    <option value="IN">ENTRADA (+)</option>
                                    <option value="OUT">SAÍDA (-)</option>
                                </select>
                            </div>
                        </div>
                        <button onclick="salvarMovimento()" class="w-full bg-navy text-white p-5 rounded-2xl font-black hover:bg-navy/90 transition-all flex items-center justify-center gap-4">
                            REGISTRAR NA PLANILHA <i class="fas fa-save"></i>
                        </button>
                    </div>
                </div>

                <!-- Aba Pedidos -->
                <div id="tabPedidos" class="hidden">
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-10">
                        <div class="lg:col-span-1 bg-stone-50 p-8 rounded-[2rem] border border-stone-100 h-fit">
                            <h3 class="text-[10px] font-black uppercase tracking-widest mb-6">Atualizar Etapa</h3>
                            <div class="space-y-6">
                                <input type="text" id="editOS" placeholder="Protocolo O.S." class="w-full p-4 rounded-2xl border-none shadow-sm font-black text-navy text-xs uppercase outline-none focus:ring-2 focus:ring-bronze">
                                <select id="editStatus" class="w-full p-4 rounded-2xl border-none shadow-sm font-black text-navy text-xs bg-white outline-none focus:ring-2 focus:ring-bronze">
                                    <option value="PEDIDO">PEDIDO RECEBIDO</option>
                                    <option value="CORTE">EM CORTE</option>
                                    <option value="COSTURA">EM COSTURA</option>
                                    <option value="ESTAMPA">EM ESTAMPA</option>
                                    <option value="PRONTO">PRONTO / RETIRADA</option>
                                    <option value="FINALIZADO">FINALIZADO / ENTREGUE</option>
                                </select>
                                <button onclick="atualizarStatusPedido()" id="btnUpdatePedido" class="w-full bg-bronze text-white p-4 rounded-2xl font-black hover:bg-bronze-light text-xs transition-all shadow-lg flex items-center justify-center gap-3">
                                    ATUALIZAR STATUS <i class="fas fa-sync-alt"></i>
                                </button>
                                <p id="pedidoMsg" class="text-center font-bold text-[10px] hidden"></p>
                            </div>
                        </div>
                        <div class="lg:col-span-2">
                            <div class="flex justify-between items-center mb-6 px-4">
                                <h3 class="text-[10px] font-black uppercase tracking-widest">Pedidos Ativos (Em Produção)</h3>
                                <button onclick="fetchPedidosAtivos()" class="text-bronze hover:text-navy transition-colors"><i class="fas fa-redo-alt"></i></button>
                            </div>
                            <div id="listaPedidosAtivos" class="space-y-4 max-h-[500px] overflow-y-auto pr-2 admin-scroll">
                                <p class="text-center py-10 text-stone-300 font-bold uppercase text-[10px]">Aguardando sincronização...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="py-20 bg-navy text-white">
        <div class="container mx-auto px-6">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-12 mb-16">
                <div class="text-center md:text-left">
                    <div class="flex items-center justify-center md:justify-start space-x-3 mb-6">
                        <div class="w-10 h-10 bg-white/10 rounded-full border border-bronze flex items-center justify-center font-serif text-bronze">S</div>
                        <span class="text-xl font-black uppercase tracking-tighter">Sua Estampa</span>
                    </div>
                    <p class="text-white/40 text-sm leading-relaxed max-w-xs mx-auto md:mx-0">
                        Referência em estamparia e confecção em São José dos Campos. Do rascunho ao uniforme pronto.
                    </p>
                </div>
                
                <div class="text-center">
                    <h4 class="text-[10px] font-black uppercase text-bronze mb-6 tracking-widest">Contacto Ofical</h4>
                    <div class="space-y-4">
                        <p class="text-sm font-bold"><i class="fab fa-whatsapp text-bronze mr-2"></i> (12) 98710-6510</p>
                        <p class="text-sm font-bold"><i class="fas fa-envelope text-bronze mr-2"></i> suaestampa.oficial@gmail.com</p>
                        <p class="text-[10px] text-white/30 uppercase mt-4 tracking-widest">SJC - SP</p>
                    </div>
                </div>
                
                <div class="flex flex-col items-center md:items-end justify-center gap-6">
                    <h4 class="text-[10px] font-black uppercase text-bronze mb-2 tracking-widest">Social</h4>
                    <div class="flex gap-6">
                        <a href="https://www.facebook.com/suaestampa.oficial" target="_blank" class="text-2xl hover:text-bronze transition-colors"><i class="fab fa-facebook"></i></a>
                        <a href="https://www.instagram.com/suaestampa.oficial" target="_blank" class="text-2xl hover:text-bronze transition-colors"><i class="fab fa-instagram"></i></a>
                        <a href="https://wa.me/5512987106510" target="_blank" class="text-2xl hover:text-bronze transition-colors"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
            </div>
            
            <div class="pt-8 border-t border-white/5 text-center">
                <p class="text-white/20 text-[9px] font-bold uppercase tracking-[0.4em]">© 2026 Sua Estampa Oficial - Todos os direitos reservados.</p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        AOS.init({ duration: 1000, once: true });

        // URL DO GOOGLE APPS SCRIPT ATUALIZADA
        const API_URL = "https://script.google.com/macros/s/AKfycbzqZleBhV5nsD8x7NCDpqDStfNtZr8w_Ywdjzcqu5P3rzXuoYilfAIkTn3XQtkwdZAI_g/exec"; 

        window.onload = () => {
            const dataInput = document.getElementById('movData');
            if(dataInput) dataInput.value = new Date().toISOString().split('T')[0];
        };

        // RASTREIO CLIENTE
        async function consultar() {
            const input = document.getElementById('inputProtocolo');
            const protocolo = input.value.trim().toUpperCase();
            const label = document.getElementById('labelBtn');
            const spinner = document.getElementById('spinner');
            const card = document.getElementById('statusResult');
            const error = document.getElementById('errorMsg');

            if (!protocolo) return;

            label.style.display = 'none';
            spinner.style.display = 'inline-block';
            error.classList.add('hidden');
            card.style.display = 'none';

            try {
                const response = await fetch(`${API_URL}?protocolo=${protocolo}`);
                const data = await response.json();

                if (data.encontrado) {
                    document.getElementById('resNome').innerText = data.nome;
                    document.getElementById('resId').innerText = `O.S. ${protocolo}`;
                    document.getElementById('resStatus').innerText = data.status;
                    document.getElementById('resPrevisao').innerText = data.previsao;
                    card.style.display = 'block';
                    updateTimeline(data.status);
                    setTimeout(() => card.scrollIntoView({ behavior: 'smooth', block: 'center' }), 100);
                } else { error.classList.remove('hidden'); }
            } catch (err) { error.classList.remove('hidden'); }
            finally { label.style.display = 'block'; spinner.style.display = 'none'; }
        }

        function updateTimeline(status) {
            const s = status.toUpperCase();
            let progress = 0;
            if (s.includes("CORTE")) progress = 20;
            else if (s.includes("COSTUR")) progress = 40;
            else if (s.includes("ESTAMP")) progress = 60;
            else if (s.includes("PRONTO")) progress = 80;
            else if (s.includes("FINAL") || s.includes("ENTREG")) progress = 100;

            document.getElementById('timelineProgress').style.width = progress + '%';
            const stages = [
                { id: 'corte', value: 20 },
                { id: 'costura', value: 40 },
                { id: 'estampa', value: 60 },
                { id: 'pronto', value: 80 },
                { id: 'fim', value: 100 }
            ];
            stages.forEach(stage => {
                const dot = document.getElementById(`dot-${stage.id}`);
                const lbl = document.getElementById(`lbl-${stage.id}`);
                if(progress >= stage.value) {
                    dot.classList.add('active');
                    lbl.classList.replace('text-stone-300', 'text-navy');
                } else {
                    dot.classList.remove('active');
                    lbl.classList.replace('text-navy', 'text-stone-300');
                }
            });
        }

        // ÁREA ADMIN
        function openAdmin() { document.getElementById('adminModal').style.display = 'flex'; }
        function closeAdmin() { document.getElementById('adminModal').style.display = 'none'; }
        
        function switchTab(tab) {
            const isCaixa = tab === 'caixa';
            document.getElementById('tabCaixa').classList.toggle('hidden', !isCaixa);
            document.getElementById('tabPedidos').classList.toggle('hidden', isCaixa);
            document.getElementById('tabBtnCaixa').classList.toggle('active', isCaixa);
            document.getElementById('tabBtnPedidos').classList.toggle('active', !isCaixa);
            if(tab === 'pedidos') fetchPedidosAtivos();
            if(tab === 'caixa') fetchFinanceiro();
        }

        function checkAdmin() {
            // Senha padrão 1234
            if(document.getElementById('adminPass').value === "1234") { 
                document.getElementById('adminLogin').classList.add('hidden');
                document.getElementById('adminContent').classList.remove('hidden');
                fetchFinanceiro();
            } else { alert("Acesso Negado."); }
        }

        async function fetchPedidosAtivos() {
            const container = document.getElementById('listaPedidosAtivos');
            container.innerHTML = '<p class="text-center py-10 text-xs font-black text-stone-300 uppercase animate-pulse">Sincronizando...</p>';
            try {
                const response = await fetch(`${API_URL}?tipo=listarPedidosAtivos`);
                const data = await response.json();
                if (data.sucesso && data.pedidos.length > 0) {
                    container.innerHTML = data.pedidos.map(p => `
                        <div class="bg-white p-5 rounded-[2rem] border border-stone-100 flex items-center justify-between hover:border-bronze transition-all shadow-sm">
                            <div class="flex items-center gap-4">
                                <div class="w-12 h-12 bg-navy text-bronze rounded-2xl flex items-center justify-center text-[11px] font-black">${p.protocolo}</div>
                                <div><p class="text-xs font-black uppercase">${p.nome}</p><span class="text-[9px] font-bold text-bronze uppercase tracking-widest">${p.status}</span></div>
                            </div>
                            <button onclick="preencherOS('${p.protocolo}', '${p.status}')" class="w-10 h-10 bg-stone-50 rounded-full flex items-center justify-center text-navy hover:bg-bronze hover:text-white transition-all shadow-inner"><i class="fas fa-edit text-xs"></i></button>
                        </div>
                    `).join('');
                } else {
                    container.innerHTML = '<p class="text-center py-10 text-[10px] font-bold text-stone-400 uppercase">Sem pedidos ativos</p>';
                }
            } catch (e) { container.innerHTML = "Falha ao carregar."; }
        }

        function preencherOS(protocolo, status) {
            document.getElementById('editOS').value = protocolo;
            const select = document.getElementById('editStatus');
            const normalized = status.toUpperCase();
            if(normalized.includes("PEDIDO")) select.value = "PEDIDO";
            else if(normalized.includes("CORTE")) select.value = "CORTE";
            else if(normalized.includes("COSTURA")) select.value = "COSTURA";
            else if(normalized.includes("ESTAMPA")) select.value = "ESTAMPA";
            else if(normalized.includes("PRONTO")) select.value = "PRONTO";
            document.getElementById('editOS').focus();
        }

        async function atualizarStatusPedido() {
            const os = document.getElementById('editOS').value.trim().toUpperCase();
            const status = document.getElementById('editStatus').value;
            const btn = document.getElementById('btnUpdatePedido');
            const msg = document.getElementById('pedidoMsg');
            if(!os) return;
            btn.disabled = true;
            msg.classList.add('hidden');
            try {
                const res = await fetch(`${API_URL}?tipo=updateStatus&protocolo=${os}&status=${status}`);
                const data = await res.json();
                if(data.sucesso) { 
                    fetchPedidosAtivos(); 
                    if(status === "FINALIZADO") document.getElementById('editOS').value = "";
                    msg.innerText = "ATUALIZADO!";
                    msg.className = "text-center font-bold text-[10px] text-green-600 mt-4 block";
                }
            } catch (e) { alert("Erro ao atualizar!"); } finally { btn.disabled = false; msg.classList.remove('hidden'); }
        }

        async function fetchFinanceiro() {
            try {
                const response = await fetch(`${API_URL}?tipo=financeiro`);
                const data = await response.json();
                if(data.sucesso) {
                    document.getElementById('finEntradas').innerText = `R$ ${data.entradas}`;
                    document.getElementById('finSaidas').innerText = `R$ ${data.saidas}`;
                    document.getElementById('finSaldo').innerText = `R$ ${data.saldo}`;
                }
            } catch (e) { console.log(e); }
        }

        async function salvarMovimento() {
            const data = document.getElementById('movData').value;
            const desc = document.getElementById('movDesc').value;
            const valor = document.getElementById('movValor').value;
            const tipo = document.getElementById('movTipo').value;
            if(!data || !desc || !valor) { alert("Preecha todos os campos financeiros."); return; }
            try {
                const res = await fetch(`${API_URL}?tipo=salvar&desc=${encodeURIComponent(desc)}&valor=${valor}&mov=${tipo}&data=${data}`);
                const resJson = await res.json();
                if(resJson.sucesso) { 
                    fetchFinanceiro(); 
                    alert("Lançamento Registrado!"); 
                    document.getElementById('movDesc').value = "";
                    document.getElementById('movValor').value = "";
                }
            } catch (e) { alert("Erro ao salvar!"); }
        }
    </script>
</body>
</html>